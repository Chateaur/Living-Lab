Imports MySql.Data.Entity
Imports MySql.Data.MySqlClient
Imports MySql.Data.Types

Public Class DataBase
    Private connexion As String = "Server=localhost;Database=living_lab;Uid=root;Pwd=;"

    Public Function connecter()
        Try
            Dim conn As MySqlConnection = New MySqlConnection

            conn.ConnectionString = connexion
            conn.Open()

            Return conn
        Catch ex As Exception
            MsgBox("Une erreur est survenue lors de la connexion à la base de données." + ex.Message)
            Return vbNull
        End Try

    End Function

    Public Function insert_into(ByVal request As String) As Integer
        Dim result As Integer = 0

        Try
            connecter().close()
            connecter()

            Dim Commande As New MySqlCommand(request, connecter)
            Commande.ExecuteNonQuery()

            connecter().close()

            result = 1
        Catch ex As Exception
            MsgBox("Une erreur est survenue lors de l'insertion dans la base de données." + ex.Message)
        End Try

        Return result
    End Function


    Public Function select_data(ByVal request As String, ByVal table_name As String) As DataSet
        Dim MonDataSet As New DataSet

        connecter().close()
        connecter()

        Dim Commande As New MySqlCommand(request, connecter)
        Dim Adaptateur As New MySqlDataAdapter(Commande)

        Adaptateur.Fill(MonDataSet, table_name)

        connecter.Close()

        Return MonDataSet
    End Function
End Class
