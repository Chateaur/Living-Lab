Public Class Ajout_patient

    Private rapport As Nouveau_Rapport

    Public Sub New(ByVal rapport As Nouveau_Rapport)

        ' Cet appel est requis par le concepteur.
        InitializeComponent()

        ' Ajoutez une initialisation quelconque après l'appel InitializeComponent().
        Me.rapport = Nouveau_Rapport
    End Sub

    Private Sub Ajout_patient_Load(sender As Object, e As EventArgs) Handles Me.Load
        Me.CenterToParent()
    End Sub

    Private Sub bt_ajout_Click(sender As Object, e As EventArgs) Handles bt_ajout.Click
        Dim rq As String = ""
        Dim bdd As New DataBase

        rq = "INSERT INTO PATIENT (nom, prenom, chambre) VALUES ('" & Me.txt_nom.Text & "','" & Me.txt_prenom.Text & "','" & Me.txt_chambre.Text & "');"
        If bdd.insert_into(rq) = 1 Then
            Me.rapport.refresh_cbx_patient()

            MsgBox("Insertion réussie")

            Me.Close()
        End If

    End Sub
End Class